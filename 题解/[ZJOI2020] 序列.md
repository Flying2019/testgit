### [链接](https://loj.ac/problem/3313)
模拟费用流。

把原题中的操作看成一些边，可以直接建图。

考虑直接跑费用流显然会挂，所以用dp处理即可。
```cpp
#include<iostream>
#include<cstdio>
#include<cstring>
#define abs(x) (x>0?x:-x)
#define ll long long
using namespace std;
ll pre,d1,d2,l,ans=0;
void make_nxt(ll a)
{
	swap(d1,d2);
	a-=l+d1;
	if(pre>0 && a>0)
	{
		ll w=max(min(a,pre),-l);
		pre-=w;
		a-=w;
		l+=w;
	}
	else if(pre<0 && a<0)
	{
		ll w=max(max(a,pre),-l);
		pre-=w;
		a-=w;
		l+=w;
	}
	d2+=pre;
	if(d2<0) l+=d2,a-=d2,d2=0;
	pre=a;
	ans+=abs(a);
}
int main()
{
	int t;
	scanf("%d",&t);
	while(t --> 0)
	{
		int n;
		scanf("%d",&n);
		ans=pre=d1=d2=l=0;
		for(int i=1;i<=n;i++)
		{
			ll a;
			scanf("%lld",&a);
			make_nxt(a);
		}
		make_nxt(0),make_nxt(0);
		printf("%lld\n",ans/2);
	}
	return 0;
}
```
注意最后要加两次0来撤销所有的区间加（跳加）。
